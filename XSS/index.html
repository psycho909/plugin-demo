<!DOCTYPE html>
<html lang="zh">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>XSS æ¸¬è©¦ & é˜²ç¦¦</title>
	</head>
	<body>
		<h2>ğŸš¨ XSS æ¸¬è©¦ & é˜²ç¦¦ç¤ºç¯„</h2>

		<h3>âŒ âš ï¸ ä¸å®‰å…¨ç‰ˆæœ¬ï¼ˆå®¹æ˜“é­å— XSS æ”»æ“Šï¼‰</h3>
		<input type="text" id="unsafeInput" placeholder="è¼¸å…¥ XSS æ¸¬è©¦å…§å®¹..." />
		<button onclick="unsafeSubmit()">æäº¤</button>
		<div id="unsafeOutput" style="border: 1px solid red; padding: 10px; margin-top: 10px"></div>

		<h3>âœ… å®‰å…¨ç‰ˆæœ¬ï¼ˆé˜²ç¯„ XSSï¼‰</h3>
		<input type="text" id="safeInput" placeholder="è¼¸å…¥å®‰å…¨å…§å®¹..." />
		<button onclick="safeSubmit()">æäº¤</button>
		<div id="safeOutput" style="border: 1px solid green; padding: 10px; margin-top: 10px"></div>

		<h3>ğŸ”¥ å¿«é€Ÿ XSS æ¸¬è©¦</h3>
		<button onclick="injectXSS1()">ğŸ–¼ `img onerror` æ¸¬è©¦</button>
		<button onclick="injectXSS2()">ğŸ”— `javascript:` é€£çµæ¸¬è©¦</button>
		<button onclick="injectXSS3()">â³ `setTimeout` å»¶é²æ¸¬è©¦</button>

		<script>
			// âŒ ä¸å®‰å…¨çš„ XSS ç‰ˆæœ¬
			function unsafeSubmit() {
				const userInput = document.getElementById("unsafeInput").value;
				document.getElementById("unsafeOutput").innerHTML = userInput; // âš ï¸ XSS æ³¨å…¥æ¼æ´
			}

			// âœ… å®‰å…¨çš„ XSS é˜²ç¯„æ–¹æ³•
			function safeSubmit() {
				const userInput = document.getElementById("safeInput").value;
				document.getElementById("safeOutput").innerHTML = escapeHTML(userInput); // âœ… é˜²æ­¢ XSS
			}

			// âœ… è½‰ç¾© HTMLï¼Œé˜²æ­¢ XSS æ”»æ“Š
			function escapeHTML(str) {
				return str.replace(
					/[&<>"']/g,
					(match) =>
						({
							"&": "&amp;",
							"<": "&lt;",
							">": "&gt;",
							'"': "&quot;",
							"'": "&#039;"
						}[match])
				);
			}

			// ğŸ”¥ å¿«é€Ÿ XSS æ¸¬è©¦æŒ‰éˆ•
			function injectXSS1() {
				document.getElementById("unsafeOutput").innerHTML = `<img src="x" onerror="alert('XSS')">`;
				document.getElementById("safeOutput").innerHTML = escapeHTML(`<img src="x" onerror="alert('XSS')">`);
			}

			function injectXSS2() {
				document.getElementById("unsafeOutput").innerHTML = `<a href="javascript:alert('XSS')">é»æˆ‘</a>`;
				document.getElementById("safeOutput").innerHTML = escapeHTML(`<a href="javascript:alert('XSS')">é»æˆ‘</a>`);
			}

			function injectXSS3() {
				document.getElementById("unsafeOutput").innerHTML = `<img src="x" onerror="setTimeout(()=>{alert('XSS')}, 2000)">`;
				document.getElementById("safeOutput").innerHTML = escapeHTML(`<img src="x" onerror="setTimeout(()=>{alert('XSS')}, 2000)">`);
			}
		</script>
	</body>
</html>
